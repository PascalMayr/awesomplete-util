// AwesompleteUtil - Nico Hoogervorst - MIT license
var AwesompleteUtil=function(){function e(e){var t=Array.isArray(e)?{label:e[0],value:e[1]}:"object"==typeof e&&"label"in e&&"value"in e?e:{label:e,value:e};return{label:t.label||t.value,value:t.value}}function t(e,t,n){return j.fire(e,t,{detail:n})}function n(n,r){var i,l,u,a,o=n.input,p=o.classList,s=n.utilprops,c=s.selected,v=s.convertInput(o.value),f=n.opened,d=[],h=n.a;if(s.prepop=!1,h){for(a=0;a<h.length;a++)if(u=h[a],i=e(n.data(u,v)),0===n.maxItems&&n.filter(i,v)&&(f=!0),l={input:{value:""}},n.replace.call(l,i),s.convertInput(l.input.value)===v){if(c&&c.value===i.value&&c.label===i.label){d=[u];break}d.push(u)}s.prevSelected!==d&&(d.length>0?r?t(o,k,d):s.changed&&(s.prevSelected=d,p.remove(w),p.add(x),t(o,A,d)):r?t(o,k,[]):s.changed&&(s.prevSelected=[],p.remove(x),f&&o===document.activeElement?p.remove(w):v.length>0&&(p.add(w),t(o,A,[]))))}}function r(e){var t=this;e.type!==E&&e.type!==L&&"blur"!=e.type||e.target!==t.input||n(t,t.utilprops.prepop&&e.type===L)}function i(e){var t=this;e.target===t.input&&9===e.keyCode&&t.select()}function l(e){var t=this;t.utilprops.changed=!0,t.utilprops.selected=e.text}function u(e){return 0===Object.keys(e).length&&e.constructor===Object}function a(e,t,n){var r=e.utilprops;return!r.b||!r.loadall&&0===t.lastIndexOf(n,0)&&(0!==t.lastIndexOf(r.b,0)||"number"==typeof r.limit&&e.a.length>=r.limit)}function o(){var e,n,r=this,i=r.c,l=r.d,o=r.e,p=i.utilprops.val;if(200===l.status){if(e=JSON.parse(l.responseText),i.utilprops.convertResponse&&(e=i.utilprops.convertResponse(e)),!Array.isArray(e))if(0===i.utilprops.limit||1===i.utilprops.limit)e=u(e)?[]:[e];else for(n in e)if(Array.isArray(e[n])){e=e[n];break}Array.isArray(e)&&a(i,p,o)&&(i.list=e,i.utilprops.b=o||i.utilprops.loadall,t(i.input,L,o))}}function p(e,t){var r;e.utilprops.url&&a(e,t,t)?(r=new XMLHttpRequest,e.utilprops.ajax(e.utilprops.url,e.utilprops.urlEnd,e.utilprops.loadall?"":t,o.bind({c:e,d:r,e:t}),r)):n(e,e.utilprops.prepop)}function s(e){var n=e.input,r=n.classList;r.remove(w),r.remove(x),t(n,A,[])}function c(e,t,n){return e.utilprops.prepop=n||!1,e.utilprops.val!==t&&(e.utilprops.selected=null,e.utilprops.changed=!0,e.utilprops.val=t,(t.length<e.minChars||0==t.length)&&s(e),t.length>=e.minChars&&p(e,t)),e}function v(e){var t,n=this;e.target===n.input&&(t=n.utilprops.convertInput(n.input.value),c(n,t))}function f(e){return j.create("li",{innerHTML:e,"aria-selected":"false"})}function d(e){return e.replace("&","&amp;").replace("<","&lt;").replace(">","&gt;")}function h(e){var t,n,r=this,i=r.f,l=r.g,u=r.h;e.target===j(i)&&("function"==typeof u?u(e,l):(t=j(u),t&&t!==document.activeElement&&(n=Array.isArray(e.detail)&&1===e.detail.length?e.detail[0]:null,n=(l&&n?n[l]:n)||"","undefined"!=typeof t.value?(t.value=n,t.classList&&t.classList.remove&&t.classList.remove(w)):"undefined"!=typeof t.src?t.src=n:t.innerHTML=n)))}function m(e){var t,n,r=this;e.target===j(r.i)&&(t=r.c,0===t.ul.childNodes.length||t.ul.hasAttribute("hidden")?(n=t.minChars,t.minChars=0,t.evaluate(),t.minChars=n):t.close())}function b(e,t,n){var r=j.regExpEscape(d(t).trim()),i=r.length<=0?null:n?RegExp("^"+r,"i"):RegExp("(?!<[^>]+?>)"+r+"(?![^<]*?>)","gi");return e.replace(i,"<mark>$&</mark>")}function y(e,t,n,r,i){var l,u=i.root,a=i.value,o=i.label||i.value,p=!0,s=[];if(0===r&&u&&n&&0!==(n+".").lastIndexOf(u+".",0)&&0!==(u+".").lastIndexOf(n+".",0))return e;if(Object(t)!==t)n?e[n]=t:e=t;else if(Array.isArray(t)){for(l=0;l<t.length;l++)s.push(y({},t[l],"",r+1,i));n?e[n]=s:e=s}else{for(l in t)p=!1,y(e,t[l],n?n+"."+l:l,r,i);p&&n&&(e[n]={})}return r<2&&n&&(a&&0===(n+".").lastIndexOf(a+".",0)&&(e.value=e[n]),o&&0===(n+".").lastIndexOf(o+".",0)&&(e.label=e[n])),0===r&&(!a||"value"in e||(e.value=null),!o||"label"in e||(e.label=null)),e}function g(){var e=this,t=e.c.input,n=e.j,r=e.k,i=e.l,l=e.m;t.removeEventListener(I,l),t.removeEventListener(L,n),t.removeEventListener(E,n),t.removeEventListener("blur",n),t.removeEventListener("input",r),t.removeEventListener("keydown",i)}var C="awesomplete-",L=C+"loadcomplete",E=C+"close",A=C+"match",k=C+"prepop",I=C+"select",x="awe-found",w="awe-not-found",j=Awesomplete.$;return{ajax:function(e,t,n,r,i){return i=i||new XMLHttpRequest,i.open("GET",e+encodeURIComponent(n)+(t||"")),i.onload=r,i.send(),i},convertInput:function(e){return"string"==typeof e?e.trim().toLowerCase():""},item:f,mark:b,itemContains:function(e,t){var n;return t.trim().length>0&&(n=(""+e).split(/<p>/),n[0]=b(n[0],t),e=n.join("<p>")),f(e,t)},itemMarkAll:function(e,t){return f(""===t.trim()?""+e:b(""+e,t),t)},itemStartsWith:function(e,t){return f(""===t.trim()?""+e:b(""+e,t,!0),t)},create:function(e,t,n){n.item=n.item||this.itemContains;var r=new Awesomplete(e,n);return r.utilprops=t||{},r.utilprops.url||"undefined"!=typeof r.utilprops.loadall||(r.utilprops.loadall=!0),r.utilprops.ajax=r.utilprops.ajax||this.ajax,r.utilprops.convertInput=r.utilprops.convertInput||this.convertInput,r},attach:function(e){var t=e.input,n=r.bind(e),u=i.bind(e),a=v.bind(e),o=l.bind(e),s=g.bind({c:e,j:n,k:a,l:u,m:o}),c={keydown:u,input:a};return c.blur=c[E]=c[L]=n,c[I]=o,j.bind(t,c),e.utilprops.detach=s,e.utilprops.prepop&&(e.utilprops.loadall||t.value.length>0)&&(e.utilprops.val=e.utilprops.convertInput(t.value),p(e,e.utilprops.val)),e},update:function(e,t,n){return e.input.value=t,c(e,t,n)},start:function(e,t,n){return this.attach(this.create(e,t,n))},detach:function(e){return e.utilprops.detach&&(e.utilprops.detach(),delete e.utilprops.detach),e},createCopyFun:function(e,t,n){return h.bind({f:j(e)||e,g:t,h:j(n)||n})},attachCopyFun:function(e,t){return t="boolean"!=typeof t||t,addEventListener(A,e),t&&addEventListener(k,e),e},startCopy:function(e,t,n,r){return this.attachCopyFun(this.createCopyFun(e,t,n),r)},detachCopyFun:function(e){return removeEventListener(k,e),removeEventListener(A,e),e},createClickFun:function(e,t){return m.bind({i:j(e)||e,c:t})},attachClickFun:function(e){return addEventListener("click",e),e},startClick:function(e,t){return this.attachClickFun(this.createClickFun(e,t))},detachClickFun:function(e){return removeEventListener("click",e),e},filterContains:function(e,t){return Awesomplete.FILTER_CONTAINS(e.value,t)},filterStartsWith:function(e,t){return Awesomplete.FILTER_STARTSWITH(e.value,t)},jsonFlatten:function(e){return y({},e,"",0,this)}}}();
//# sourceMappingURL=awesomplete-util.min.js.map
